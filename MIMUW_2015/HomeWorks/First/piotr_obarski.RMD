---
title: "Regresja liniowa - praca domowa"
author: "Piotr Obarski"
date: "6.10.2015"
output: 
  html_document:
  toc: TRUE
---

Na pocz¹tku ³adujemy bibliotekê, w której s¹ nasz dane.
```{r}
library("PBImisc")
```
W tej bibliotece bêdziemy zajmowaæ siê danymi zawartymi w obiekcie heights tj. wzrostami ma³¿onków. SprawdŸmy jak wygl¹daj¹ te dane.
```{r}
head(heights)
```
Teraz zróbmy podgl¹dowy wykres, by wstêpnie oceniæ czy jest jakaœ zale¿noœæ pomiêdzy danymi.
```{r}
plot(Wife~Husband, data=heights)
```

Na wykresie widaæ, ¿e taka zale¿noœæ powinna byæ i jest ona pozytywna tj. czym wy¿szy m¹¿ tym wy¿sza ¿ona.
Wyznaczmy wspó³czynniki modelu liniowego opisuj¹cego zale¿noœæ pomiêdzy naszymi danymi.
```{r}
model<-lm(Wife~Husband, data=heights)
model$coefficients
```
Teraz, dla wspó³czynnika nachylenia wyznaczymy 95% przedzia³ ufnoœci obliczeniowo za pomoc¹ metody bootstrap resztowy.
```{r}
N <- 5000
nwsp <- replicate(N, {
  ndf <- data.frame(x = heights$Husband,
                    y = model$fitted.values + sample(model$residuals))
  model2 <- lm(y~x, data=ndf)
  model2$coefficients
})
df <- data.frame(intercept = nwsp[1,], slope = nwsp[2,])
par(mfrow=c(1,1))
hist(df$slope, 100, col="grey")
quantile(df$slope,c(.025,.975))
```